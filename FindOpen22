import nmap

# Define the file path for the list of subnets
subnet_file_path = "/home/Scanning/22check.lst"

# Define the file path for the output file
output_file_path = "/home/Scanning/22open.lst"

# Initialize the nmap scanner
nm = nmap.PortScanner()

# Open the file containing the list of subnets
with open(subnet_file_path, "r") as subnet_file:
    # Loop over each subnet in the file
    for subnet in subnet_file:
        # Remove any trailing whitespace from the subnet
        subnet = subnet.strip()
        # Scan the subnet for hosts with port 22 open
        nm.scan(hosts=subnet, arguments="-p 22 --open")
        # Loop over each host that was found with port 22 open
        for host in nm.all_hosts():
            # Check if port 22 is open on the host
            if nm[host]["tcp"][22]["state"] == "open":
                # Print the host and port information to the terminal
                print(f"{host}:22 is open")
                # Write the host and port information to the output file
                with open(output_file_path, "a") as output_file:
                    output_file.write(f"{host}:22 is open\n")
